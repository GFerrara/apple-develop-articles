<html>
<head>
<!-- Article ID: 31 - Extracted from develop-1992 -->
<!-- on 2024-01-22 by Giorgio Ferrara - giorgio<dot>ferrara<at>gmail<dot>com -->
<!-- The content is protected by copyright of their respective owners -->
<title>August 92 - KON & BAL'S PUZZLE PAGE</title>
<link href="styles/main.css" rel="stylesheet" type="text/css">
</head>
<body>
<h2>KON &amp; BAL'S PUZZLE PAGE</h2>
<h2>AN OFF-COLOR PUZZLE</h2>
<h1>KONSTANTIN OTHMER AND BRUCE LEAK</h1>
<p>
<img src="img/209.gif" width="180 px"></img>
</p>
<p>
<i>See if you can solve this programming puzzle, presented in the form of a dialog</i><br>
<i>between Konstantin Othmer (KON) and Bruce Leak (BAL). The dialog gives clues to</i><br>
<i>help you. Keep guessing until you're done; your score is the number to the left of the</i><br>
<i>clue that gave you the correct answer. These problems are supposed to be tough. If you</i><br>
<i>don't get a high score, at least you'll learn interesting Macintosh trivia.</i>
</p>
<p>
<b>100</b> BAL This guy has this program that leaves all the palette colors messed up after<br>
his program quits.
</p>
<p>
KON Yeah, I've seen it. He's probably got version 1.0 of that KeithPaint program.
</p>
<p>
<b>90</b> BAL This is something he wrote with MPW C, and he spent days debugging his code<br>
with SADE. He's sure it's not his problem.
</p>
<p>
KON Sounds like some kind of Palette Manager nastiness.
</p>
<p>
<b>80</b> BAL He sends you a copy and it works fine on your machine.
</p>
<p>
KON Which system is he running? How many monitors does he have?
</p>
<p>
<b>75</b> BAL You're both running 6.0.7 on a Macintosh fx with one Apple 13-inch color<br>
monitor.
</p>
<p>
KON That's a nice programming environment. Why doesn't he upgrade to System 7 and<br>
buy himself a real monitor?
</p>
<p>
<b>70</b> BAL Well, he has System 7 on a Macintosh Quadra with a 16-inch color monitor<br>
for reading NetNews and watching QuickTime movies. But the bug doesn't happen on<br>
that machine.
</p>
<p>
KON So it must be some INIT conflict. What's he got, ColorDesk or something?
</p>
<p>
<b>65</b> BAL Nope, happens without any INITs.
</p>
<p>
KON He's using the Color Manager and calling some nasty thing like SaveEntries or<br>
RestoreEntries, and he isn't MultiFinder compatible. I tell him to use the Palette<br>
Manager.
</p>
<p>
<b>60</b> BAL He's using the Palette Manager, and he's totally MultiFinder friendly.
</p>
<p>
KON Sounds impossible. I swap motherboards with him.
</p>
<p>
<b>55</b> BAL Still happens, just on his machine. If you swapped hard drives it would happen<br>
on yours.
</p>
<p>
KON It's got to be some kind of GDevice color table thing. I check the GDevice color<br>
table before and after running his program.
</p>
<p>
BAL Wait a second. Who has which hard drive?
</p>
<p>
KON I have mine, he has his.
</p>
<p>
<b>50</b> BAL The color tables are different on his GDevice, but the same on yours.
</p>
<p>
KON Well, who restores the color table? PaletteMgrExit or something like that, right?
</p>
<p>
<b>45</b> BAL The Palette Manager changes the color environment only when a window with<br>
an associated palette comes to the front. This method assumes that people who need<br>
colors request them, and people who don't request colors don't care enough to affect the<br>
color environment.&nbsp;&nbsp;Unfortunately, with this approach to color management, when an<br>
application that's Palette Manager intensive quits, and an application such as the<br>
Finder which has no intensive color demands comes to the front, you're stuck with the<br>
nonstandard color state of the application that just quit. In 32-Bit QuickDraw David<br>
Van Brink extended the Palette Manager to include a routine called PaletteMgrExit.<br>
This routine is called automatically for you when your application quits, thus<br>
restoring the default color state.
</p>
<p>
KON Don't you have the same problem when twitching between layers? If you twitch to<br>
the Finder and the other application is still running, you'll be stuck with the<br>
nonstandard color state too.
</p>
<p>
<b>40</b> BAL Yeah, but there's still an application around that needs those colors, and you<br>
can potentially see that application's documents, so it's a good bet to keep them. No one<br>
is specifically asking for the standard colors, and someone wants the others, so why<br>
not keep them around? If you twitch to another application that had palettes, obviously<br>
its color needs will be satisfied.
</p>
<p>
KON So in effect you start out with a default color world, and you launch an application<br>
that twists the colors to the demands of a particular document you're viewing or<br>
editing. Upon quitting that application your machine is left in some nonstandard color<br>
state. So PaletteMgrExit cleans up the mess.
</p>
<p>
<b>35</b> BAL That's basically it, but just going back to the default color environment when<br>
an application quits isn't sufficient. PaletteMgrExit reverts to the default color set<br>
modified to accommodate the application coming to the front.
</p>
<p>
KON I set an ATB on PaletteMgrExit and see if it gets called.
</p>
<p>
<b>30</b> BAL It's called on your machine, but not his.
</p>
<p>
KON Well, ExitToShell is supposed to call it, and it's hard to call ExitToShell wrong, so<br>
there must be some system problem.
</p>
<p>
<b>25</b> BAL Welcome to the Puzzle Page, KON. Maybe this would be an excellent<br>
opportunity to fire up one of those many fine Macintosh debugging environments, Mr.<br>
MacsBug.
</p>
<p>
KON Clearly _ExitToShell is different. So I list ExitToShell with MacsBug and see<br>
who's there.
</p>
<p>
<b>20</b> BAL It's in RAM.
</p>
<p>
KON I see whose heap it's in using HZ.
</p>
<p>
<b>15</b> BAL It's above all heaps.
</p>
<p>
KON So it's in MultiFinder memory. He must be running an old version of MultiFinder<br>
that doesn't know about PMgrExit.
</p>
<p>
<b>10</b> BAL Yeah, you know that SetAside MultiFinder they still ship with SADE?
</p>
<p>
KON Version 6.1b9. Sounds like they never really finished it.
</p>
<p>
<b>5</b> BAL Well, my hero Phil Goldman broke off the sources to add that SetAside stuff, but<br>
it was never shipped as an official Apple release, since System 7 was just around the<br>
corner. SADE needed that feature because they twitch in some weird way. So they're<br>
sort of stuck using that version, while the rest of the world moves on. And they keep<br>
shipping that old MultiFinder for those last two, die-hard, System 6 developers.<br>
System 7 SADE users don't have this problem.
</p>
<p>
KON Nasty.
</p>
<p>
BAL Yeah.
</p>
<p>
<b>KONSTANTIN OTHMER AND BRUCE LEAK</b>Between vacations, KON and BAL often<br>
find themselves under a lot of pressure to catch up on their work load. When BAL gets<br>
himself in too deep, he calls
</p>
<p>
KON in for assistance. They try to hash out their puzzling problems at Apple's Fitness<br>
Center---although
</p>
<p>
KON admits to having trouble staying focused, due to what we can only call his<br>
"wandering eye." When not working on Puzzle Pages and <i> develop </i> articles,
</p>
<p>
KON and
</p>
<p>
BAL actually write software. As a follow-on to their previous QuickDraw and<br>
QuickTime successes, look for QuickFit, featuring QuickTime-based exercise videos<br>
and QuickBuf protein powder. You read it here first! *
</p>
<p>
<b>SCORING</b>
</p>
<ul>
<li>90-100 So you're still using System 6 with SADE? Upgrade to System 7<br>
immediately!</li>
<li>60-80 Do you swear to tell the truth, the whole truth, and nothing but<br>
the truth?</li>
<li>35-55 Good job. Next time you're in L.A., try out for "Jeopardy."</li>
<li>5-30 Hey, we're with you! MacsBug users through and through. *</li>
</ul>
<p>
<b>Thanks</b> to Sean Callahan, Scott Douglass, and David Van Brink for reviewing this<br>
column.*
</p>
</body>
</html>
