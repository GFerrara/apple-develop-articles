<!DOCTYPE html>
<html>
<head>
<!-- Article ID: 38 - Extracted from develop-1993 -->
<!-- on 2024-02-03 by Giorgio Ferrara - giorgio<dot>ferrara<at>gmail<dot>com -->
<!-- The content is protected by the copyright of its respective owners -->
<title>September 93 - KON & BAL'S PUZZLE PAGE</title>
<link href="../common/styles/main.css" rel="stylesheet" type="text/css">
</head>
<body>
<h2>KON &amp; BAL'S PUZZLE PAGE</h2>
<h2>I'M HERE TO SERVE</h2>
<h1>KONSTANTIN OTHMER AND BRUCE LEAK</h1>
<p>
<img src="img/229.gif" width="191 px"></img>
</p>
<p>
<i>&nbsp;See if you can solve this programming puzzle, presented in the form of a dialog </i><br>
<i>between Konstantin Othmer (KON) and Bruce Leak (BAL). The dialog gives cluesto help</i><br>
<i>you.&nbsp;&nbsp;Keep guessing until you're done; your score is the number to the left of the clue </i><br>
<i>that gave you the correct answer. These problems are supposed to be tough. If&nbsp;&nbsp;you</i><br>
<i>don't get a high score, at least you'll learn interesting Macintosh trivia.</i>
</p>
<p>
BAL Here's one for you, KON: I've got this server that I store builds on. It's a Macintosh<br>
ci running System 7.1 with File Sharing enabled, hooked up over Ethernet. The server<br>
runs an experimental MPW tool that spins the beach-ball cursor (don't they all?)<br>
waiting for a build to appear; then it renames the build with the next release number<br>
and makes it available to the public. Early on we had some problems with the tool and<br>
it would occasionally crash the server, but that seems to be working now.
</p>
<p>
KON So what's the problem?
</p>
<p>
BAL When I use the Finder to copy my latest build out there, it crashes the server. Yet<br>
when I use the duplicate command as part of the MPW build script for my project, it<br>
works.
</p>
<p>
KON I thought you did all your builds in THINK C.
</p>
<p>
BAL Of course, but I use MPW for file management just like the guys on the Finder<br>
team.
</p>
<p>
KON Chalk one up for MPW.
</p>
<p>
BAL But that's not all. When I use the Finder to copy other files out to the server it<br>
works fine. Solve me, KON. Over.
</p>
<p>
KON I'm suspicious of that MPW shell script running on the server. It's continuously<br>
making file system calls while File Sharing is trying to copy your file over in the<br>
background. There must be some contention caused by MPW trying to rename the file<br>
while it's still in the process of being copied.
</p>
<p>
BAL Come on, KON, what do you think we're running here? This is System 7 we're<br>
talking about. Don't you think we would get something like that right on the seventh<br>
try?
</p>
<p>
KON No comment.
</p>
<p>
<b>100</b> BAL If I stop the MPW shell script running on the server or even quit MPW<br>
completely, the server still crashes when I use the Finder to copy my build to it.
</p>
<p>
KON Are the Finder copies that crash file-size dependent?
</p>
<p>
<b>95</b> BAL Size doesn't seem to matter. The Finder can successfully copy files that are the<br>
same size, smaller, and bigger than mine without crashing the server.
</p>
<p>
KON So it's the server that's crashing?
</p>
<p>
BAL Yeah, the progress bar comes up on the client machine, the copy starts, and then<br>
almost immediately the server crashes and the client machine hangs in XPP's two-<br>
minute penalty box.
</p>
<p>
KON There's an updated version of the StopXPP dcmd that works with System 7 for all<br>
those MacsBugphiles. Install that baby and you're golden. When the client hangs<br>
because the server has gone away, just drop into MacsBug and type StopXPP to force<br>
the connection to time out immediately. Any other problems?
</p>
<p>
<b>90</b> BAL Yeah, yeah, yeah. I've already got that dcmd. My machine isn't hung anymore,<br>
but the server is still crashed and your point total is still falling.
</p>
<p>
KON You packrat! You stole one of those rev J Apple Ethernet cards from Van Brink's<br>
garage. It's dropping bits, same as it ever did, and the way the Finder is slicing up<br>
your bit stream chokes it.
</p>
<p>
<b>85</b> BAL Sorry, it's rev K of the card -- the one that only drops bits when you're<br>
running in 32- bit mode -- but the ci has only 8 megs of RAM and is running in<br>
24-bit mode.
</p>
<p>
KON OK, I'll try Third-Party Cards for $200.
</p>
<p>
<b>80</b> BAL KON, I use only Apple equipment. Throw the card out altogether, use<br>
LocalTalk, and it still happens. Get a life.
</p>
<p>
KON Are there any other cards in the ci that are dropping bits? Perhaps the Apple ci<br>
cache card?
</p>
<p>
<b>75</b> BAL No cards, but if it makes you feel any better, I'll have Vanna swap in a new ci,<br>
keeping only the hard disk; it still happens.
</p>
<p>
KON I don't want a ci anymore. How 'bout we try an fx, or maybe even a Classic?
</p>
<p>
<b>70</b> BAL Vanna's getting a little tired here. Bad news: it still happens on all of them.
</p>
<p>
KON What if we try one of those NuTek boxes?
</p>
<p>
<b>65</b> BAL Fine. It crashes on boot. Next.
</p>
<p>
KON And swapping out the hard drive fixes it?
</p>
<p>
<b>60</b> BAL Swapping out the hard drive stops the server from crashing. Any chance I can<br>
solve this problem and preserve my existing hardware investment?
</p>
<p>
KON So there's something wrong with your system software or the File Sharing<br>
software on that drive. I'll reinstall all that stuff and watch it work beautifully.<br>
Problem solved.
</p>
<p>
<b>55</b> BAL<i> Not!</i>&nbsp;&nbsp;After you reinstall System 7.1 and all the bogus networking disks, and<br>
reinstall MacsBug and the dcmds from the virgin copies that came with that <i> Debugging</i><br>
<i>Macintosh Software</i>&nbsp;&nbsp;book, ISBN #0-201-57049-1, it still happens.
</p>
<p>
KON I never really trusted installing over existing corrupt software. So I throw<br>
everything in the trash, empty the trash, and reinstall fresh.
</p>
<p>
<b>50</b> BAL It still happens.
</p>
<p>
KON Maybe the volume allocation is messed up: you've got some bad I-nodes, circular<br>
B- tree references, or some other HFS mumbo jumbo. I'll confer with Dr. Norton and<br>
see what he thinks.
</p>
<p>
<b>45</b> BAL Doctors Norton, Feldman, and Bruffey, Disk FirstAid, and others all give it a<br>
clean bill of health, though a few file dates were wrong and they've been fixed.
</p>
<p>
KON So maybe some part of the media went bad, producing bad sectors or ambiguous<br>
data. I'll do a media test using Silverlining.
</p>
<p>
<b>40</b> BAL The media is fine. OK, KON. Quit screwing around. It's not a hardware problem.
</p>
<p class="spacer">&nbsp;</p>
<p>
KON But when I replaced the hard disk, the problem went away. What remains after I<br>
throw all the files away? Well, the driver persists. I'll update the driver with the<br>
utility software that came with the drive.
</p>
<p>
<b>35</b> BAL It still happens. It doesn't have anything to do with the driver.
</p>
<p>
KON I'll try SneakerNet!
</p>
<p>
<b>30</b> BAL Well, transferring the file by floppy disk doesn't work either, using the<br>
Finder on the server. Surprisingly, this most reliable means of networking doesn't<br>
work even though you aren't using high-density floppies. In this case paper clips don't<br>
even help.
</p>
<p>
KON OK, I reformat the drive and reinstall the software fresh.
</p>
<p>
<b>25</b> BAL Now it works. So what's the bug?
</p>
<p>
KON Well, the reformatting changed the interleave, and there was some weird timing<br>
problem hosing you.
</p>
<p>
<b>20</b> BAL Enough grasping at straws. Remember it only happens with my file or copies<br>
of my file. Get those rusty old gears turning.
</p>
<p>
KON I'll chop the file into pieces and see if those still crash the server when I copy<br>
them. I'll strip out all the CODE resources with ResEdit and try that file.
</p>
<p>
<b>15</b> BAL The file is pretty small now, and it still crashes.
</p>
<p>
KON I strip out all the data by setting the EOF.
</p>
<p>
<b>10</b> BAL It still crashes. Look, I can build it from scratch, I can build it on other<br>
machines, I can change the code that's in it, other people can build it on their<br>
machines, it happens with Ethernet, SneakerNet, LocalTalk, you name it -- it still<br>
crashes.
</p>
<p>
KON And people thought we'd run out of these puzzles.
</p>
<p>
BAL I got a great one for next time, too, but you've got to finish this one first.
</p>
<p>
KON So what makes my file my file? If it's not the name, the data in it, or the creation<br>
date, it's got to be the container info -- the icon, the file type, the creator, that stuff.
</p>
<p>
BAL&nbsp;&nbsp;Your puzzle, KON.
</p>
<p>
KON The Desktop Manager previously used only by AppleShare is used by the Finder in<br>
System 7, right?
</p>
<p>
<b>5</b> BAL Yeah, there are two invisible data files: Desktop DB and Desktop DF. Desktop DF<br>
has the all the data for the icons, and Desktop DB has information for all files: the<br>
document-to-application binding, the file-to-icon binding, and the file-to-comment<br>
binding. For each application creator, it keeps a list of all the applications of that type<br>
with the newest one first. That way when you double-click a document, the Finder<br>
launches the newest version of the application that handles that document.
</p>
<p>
KON I get it. The desktop database got corrupted by the experimental MPW tool you had,<br>
and when the Finder tries to update the database, it reads bad data and chokes.
</p>
<p>
BAL It worked when copying files via MPW because MPW doesn't try to keep the<br>
desktop database up to date.
</p>
<p>
KON So you should be able to rebuild the desktop database by holding down the Command<br>
and Option keys while booting. Then everything will work great.
</p>
<p>
BAL&nbsp;&nbsp;I knew the AppleShare servers are the most reliable in the business, and I<br>
couldn't believe we got one to crash.
</p>
<p>
KON Well, if you want to write sleazy MPW tools that you haven't fully debugged, you<br>
get what's coming to you.
</p>
<p>
BAL In fact, for ultimate security on a network server, you should lock it in a room<br>
and not run any weird stuff that isn't endorsed by your AppleShare administrator.
</p>
<p>
KON Right! But if you insist on running untested code, you get what you pay for.
</p>
<p>
BAL Nasty.
</p>
<p>
KON Yeah.
</p>
<p class="spacer">&nbsp;</p>
<p>
<b>KONSTANTIN OTHMER AND BRUCE LEAK </b>spent some time in the county slammer<br>
this summer, BAL for bungee jumping off a Cupertino freeway overpass and KON for<br>
losing the landmark "KON versus Stockton Board of Health" tenants-rights trial. They<br>
were able to get reduced sentences by working as waiters in "Pro Bono," the prison's<br>
nouvelle cuisine restaurant, (see photo) and faithfully adhering to the <i> Macintosh</i><br>
<i>Human Interface Guidelines</i> .*
</p>
<p>
<b>SCORING</b>
</p>
<ul>
<li>75-100 Excellent! Link your r&#233;sum&#233; to DEVELOP.</li>
<li>50-70 Not bad. Link your r&#233;sum&#233; to MACTECHMAG.</li>
<li>25-45 Hmmm. Better sit on that r&#233;sum&#233; for a while.</li>
<li>5-20 At least you beat KON's score!*</li>
</ul>
<p>
<b>Thanks</b> to Gary Davidian, Pat Dirks, scott douglass, Kevin Stinson, and Chris Zuleeg<br>
for reviewing this column. *
</p>
</body>
</html>
